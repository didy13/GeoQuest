<!DOCTYPE html>
<html lang="en">
    <%- include("./partials/head.ejs") %>
    <script>
        const indexData = [];
        async function userCount(){
            try {
                const response = await fetch('/user-count');
                const data = await response.json();

                if (Array.isArray(data)) {
                    indexData.push(...data); // ✅ Spread syntax to add multiple items correctly
                } else {
                    indexData.push(data); // ✅ Push single object if not an array
                }
            }
            catch(error){
                console.error("Error loading user count:", error);
            }
        }
        async function index() {
        try {
            const response = await fetch('/api/weather'); // Fetch data from backend
            const data = await response.json(); // Convert response to JSON
            
            if (Array.isArray(data)) {
                indexData.push(...data); // ✅ Spread syntax to add multiple items correctly
            } else {
                indexData.push(data); // ✅ Push single object if not an array
            }


            console.log("Index Data Loaded:", indexData); // Debugging (Optional)
            
            
        } catch (error) {
            console.error("Error loading quiz data:", error );
        }
        }
        function populateUserCount(){
            $(".userCount").html(indexData[0].userCount + "+");
        }
        function populate(){
            console.log(indexData[0]);
            
            if(indexData[1].weather){
                
                if (indexData[1].weather.weather.icon && indexData[1].weather.weather.icon.url) {
                    console.log("ma da");
                    $(".weatherImg").attr("src", indexData[1].weather.weather.icon.url);
                    $(".weatherImg").attr("alt", indexData[1].weather.weather.description);
                }
                else{
                    $(".weatherMain").append("<p>Nije dostupna ikona da opiše trenutno vreme</p>");
                }
                
                $(".weatherMain").append(`
                    <p><span>Temperatura:</span>  ${indexData[1].weather.weather.temp && indexData[1].weather.weather.temp.cur ? indexData[1].weather.weather.temp.cur : 'N/A'} °C</p> 
                    <p><span>Subjektivni osećaj:</span>  ${indexData[1].weather.weather.feelsLike && indexData[1].weather.weather.feelsLike.cur ? indexData[1].weather.weather.feelsLike.cur : 'N/A'} °C</p>
                    <p><span>Vlažnost vazduha:</span>  ${indexData[1].weather.weather.humidity !== undefined ? indexData[1].weather.weather.humidity : 'N/A'} %</p>
                    <p><span>Pritisak:</span> ${indexData[1].weather.weather.pressure !== undefined ? indexData[1].weather.weather.pressure : 'N/A' } hPa</p>
                    <p><span>Brzina vetra:</span>  ${indexData[1].weather.weather.wind && indexData[1].weather.weather.wind.speed ? indexData[1].weather.weather.wind.speed : 'N/A' } m/s</p>
                    <p><span>Vidljivost:</span>  ${indexData[1].weather.weather.visibility ? indexData[1].weather.weather.visibility / 1000 : 'N/A' } km</p>`
                );
            } else {
                $(".weatherMain").append(`<p>Trenutno ne možemo prikazati podatke o vremenu.</p>`);
            }
            
        }
        async function init(){
            $(document).ready(async () => {
                await userCount();
                populateUserCount();
                await index();
                populate();
            });
            
        }
        init();
    </script>
<body class="HomePage">

    <section class="HeroSection">
        <div class="NatureOverlay">
            <header>
                <%- include("./partials/nav.ejs") %>
            </header>
            <div class="container text-center HeroItems">
                <img src="images/Logo.png" alt="GeoQuest" loading="lazy">
                <h1>Koliko dobro poznaješ geografiju?</h1>
                <p>GeoQuest je edukativna aplikacija koja nudi interaktivne kvizove o geografiji. Testirajte svoje znanje o zemljama sveta, njihovim glavnim gradovima, zastavama i mnogim drugim geografski relevantnim temama. Pridružite se izazovu, proširite svoje geografsko znanje i zabavite se sa prijateljima!</p>
                <p class="HeroCTA">Izazovi sebe, dokaži da si geo ekspert i zauzmi prvo mesto!</p>
                <p>Pridruži se preko <span class="userCount"></span> takmičara širom Balkana!</p>
                <a href="/kviz-stranica" class="a-dugme">
                    <button type="button" class="btn dugme">Kreni kviz</button>
                </a>
            </div>            
        </div>
    </section>

    <section class="container ZastoGeoQuest">
        <div class="row text-center">
            <div class="col-12">
                <h2>Zašto <span class="LightBlueSpan">GeoQuest?</span></h2>
                <p>GeoQuest nije samo kviz — to je edukativna platforma koja spaja zabavu i učenje! Naša misija je da pomognemo korisnicima da unaprede svoje geografsko znanje kroz interaktivne izazove i kvizove.</p>

                <p>Da li ste ikada želeli da testirate svoje znanje o zemljama, njihovim glavnim gradovima, zastavama ili kontinente? GeoQuest nudi sve ovo i mnogo više! S više od <span>1000 pitanja</span> koja pokrivaju širok spektar geografskih tema, naš kviz je savršen način da proverite koliko dobro poznajete svet oko sebe.</p>

                <p>GeoQuest je više od običnog testa. Kroz zanimljive i edukativne izazove, možete naučiti mnoge geografske činjenice, od prepoznavanja zastava do saznanja o broju stanovnika zemalja. Pored toga, naš kviz je dizajniran tako da bude dostupan svima, bez obzira na nivo znanja, i omogućava vam da se igramo i učimo u bilo kom trenutku!</p>
            </div>
        </div>
    </section>
    

    <section class="container DaLiSteZnali">
        <div class="row d-flex align-items-center">
            <div class="col-md-6 col-12">
                <h2 class="mb-2">Da li ste znali?</h2>
                <p class="mb-2">Da li ste znali da čak <span>50% ljudi</span> iz Srbije ne može tačno da kaže sa koliko država se Srbija graniči?</p>
                <p class="mb-2">Da li ste znali da mnogi ljudi u Beogradu ne znaju koja reka protiče ispod <span>Brankovog mosta</span>?</p>
                <p class="mb-4">Credit: <span>@nevenclips</span> (TikTok)</p>
                <p class="DaLiSteZnaliCTA">Testirajte svoje geografsko znanje i proverite da li ste među onima koji znaju!</p>
                <a href="/kviz-stranica" class="a-dugme">
                    <button type="button" class="btn dugme DaLiSteZnaliDugme">Kreni kviz</button>
                </a>
            </div>
            <div class="col-md-6 col-12 Videos">
                <video class="Video1" width="281" height="500" controls>
                    <source src="videos/GraniceSrbije.mp4" type="video/mp4">
                    <source src="videos/GraniceSrbije.ogg" type="video/ogg">
                    Your browser does not support the video tag.
                </video>
                <video class="Video2" width="281" height="500" controls>
                    <source src="videos/BrankovMost.mp4" type="video/mp4">
                    <source src="videos/BrankovMost.ogg" type="video/ogg">
                    Your browser does not support the video tag.
                </video>
            </div>
        </div>
    </section>

    <section class="container StaNasiKorisniciKazu">
        <div class="row text-center">
            <div class="col-12">
                <h2>Šta naši korisnici kažu</h2>
                <div class="card-group mt-4">
                    <div class="card cardCSS">
                        <div class="card-body">
                            <p class="card-text cardText">"Nikad nisam bio toliko zabavljen učestvujući u kvizu o geografiji! Sjajan način da se testiram i naučim nove stvari."</p>
                            <p class="card-footer cardFooter"><strong>Filip, 18, Kovačica</strong></p>
                        </div>
                    </div>
                    <div class="card cardCSS">
                        <div class="card-body">
                            <p class="card-text cardText">"Ovo je moj omiljeni način da poboljšam svoje znanje o državama i glavnim gradovima. Svakodnevno igram sa prijateljima!"</p>
                            <p class="card-footer cardFooter"><strong>Saška, 22, Pančevo</strong></p>
                        </div>
                    </div>
                    <div class="card cardCSS">
                        <div class="card-body">
                            <p class="card-text cardText">"Pored toga što je zabavno, GeoQuest je sjajan alat za učenje i pripremu za geografske testove. Sve preporuke!"</p>
                            <p class="card-footer cardFooter"><strong>Dušan, 18, Starčevo</strong></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <section class="col-12 text-center Vreme">
        <h2 class="mb-1">Vreme u <%= city.original %></h2>
        
            <div class="weatherMain">
                
                    <div>
                        <img class="weatherImg" src="" alt="">
                    </div>
                
                    
                

                
            </div>
        
            
        
    </section>

    <section class="container FAQ">
        <div class="row">
            <div class="col-12">
                <h2>Česta pitanja</h2>
                <div class="accordion mt-4" id="faqAccordion">
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="heading1">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1" aria-expanded="false" aria-controls="collapse1">
                                Ko su The Šmekeri?
                            </button>
                        </h2>
                        <div id="collapse1" class="accordion-collapse collapse" aria-labelledby="heading1" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                The Šmekeri su Aleksa Stankić, David Koloski, Stefan Mizdrak i Stefan Sofronijević, tim koji je stvorio GeoQuest!
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="heading2">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2" aria-expanded="false" aria-controls="collapse2">
                                Kako je nastala ova aplikacija?
                            </button>
                        </h2>
                        <div id="collapse2" class="accordion-collapse collapse" aria-labelledby="heading2" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                GeoQuest je nastao kao deo domaćeg zadatka na FON-ovom hakatonu, gde smo sa našim projektom stigli do finala. Odučili smo da nastavim da radimo na njemu, da ga unapređujemo i održavamo!
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="heading3">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3" aria-expanded="false" aria-controls="collapse3">
                                Da li je GeoQuest besplatan?
                            </button>
                        </h2>
                        <div id="collapse3" class="accordion-collapse collapse" aria-labelledby="heading3" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Da, GeoQuest je potpuno besplatan za korišćenje!
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="heading4">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4" aria-expanded="false" aria-controls="collapse4">
                                Koliko traje jedan kviz?
                            </button>
                        </h2>
                        <div id="collapse4" class="accordion-collapse collapse" aria-labelledby="heading4" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Kviz traje 10 minuta, i to je dovoljno vremena da se dokažete u svim nivoima pitanja.
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="heading5">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5" aria-expanded="false" aria-controls="collapse5">
                                Kakva pitanja mogu da očekujem?
                            </button>
                        </h2>
                        <div id="collapse5" class="accordion-collapse collapse" aria-labelledby="heading5" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Pitanja su podeljena u tri nivoa: laka, srednja i teška. Pitanja obuhvataju teme kao što su zastave, glavni gradovi, brojevi stanovnika, kontinenti i mnoge druge geografske zanimljivosti.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <%- include("./partials/footer.ejs") %>
</body>
</html>
